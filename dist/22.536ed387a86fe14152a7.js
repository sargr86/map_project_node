(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{DYpl:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r("QJY3"),o=r("9xOu"),i=r("YpNe"),a=r("oUVn"),s=r("7dP1"),l=r("sZZ2"),p=r("tVj7"),c=r("BOF4"),m=r("TYT/"),d=r("DUip"),u=r("qT8p"),f=r("GsDI"),g=r("eHTH"),h=r("cSbt"),v=r("Valr"),b=r("p+mS"),y=r("uad8"),C=r("wUEx");function I(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"div"),m["\u0275\u0275text"](1,"First name is required"),m["\u0275\u0275elementEnd"]())}function _(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",17),m["\u0275\u0275template"](1,I,2,0,"div",18),m["\u0275\u0275elementEnd"]()),2&e){var r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",r.firstName.hasError("required"))}}function x(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"div"),m["\u0275\u0275text"](1,"Last name is required"),m["\u0275\u0275elementEnd"]())}function O(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",17),m["\u0275\u0275template"](1,x,2,0,"div",18),m["\u0275\u0275elementEnd"]()),2&e){var r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",r.lastName.hasError("required"))}}function F(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",17),m["\u0275\u0275elementStart"](1,"div",19),m["\u0275\u0275text"](2,"E-mail is required"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"div",19),m["\u0275\u0275text"](4,"E-mail is invalid"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){var r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("hidden",!r.email.hasError("required")),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("hidden",!r.email.hasError("patternInvalid"))}}function P(e,t){if(1&e&&m["\u0275\u0275element"](0,"mat-spinner",20),2&e){var r=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("diameter",r.spinnerDiameter)}}function S(e,t){if(1&e){var r=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"dropzone",21,22),m["\u0275\u0275listener"]("removedFile",(function(){return m["\u0275\u0275restoreView"](r),m["\u0275\u0275nextContext"]().removeImage()}))("thumbnail",(function(e){return m["\u0275\u0275restoreView"](r),m["\u0275\u0275nextContext"]().onAddedFile(e)})),m["\u0275\u0275elementEnd"]()}if(2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275property"]("config",n.dropzoneConfig)("message","Click or drag an image to upload")}}function E(e,t){if(1&e){var r=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div",23),m["\u0275\u0275pipe"](1,"getImageUrl"),m["\u0275\u0275elementStart"](2,"i",24),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](r),m["\u0275\u0275nextContext"]().removeImage()})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275styleProp"]("background",m["\u0275\u0275pipeBind3"](1,2,n.profileImg,"users",!0),m["\u0275\u0275defaultStyleSanitizer"])}}var k=function(){function e(e,t,r,a,s,l,p,c){this._fb=e,this._route=t,this.common=r,this.router=a,this.auth=s,this.toastr=l,this.stripeService=p,this.usersService=c,this.dropzoneFile={},this.spinnerDiameter=o.J,this.dropzoneConfig=i.a,this.cardOptions=o.K,this.elementsOptions={locale:"en"},this.profileForm=this._fb.group({first_name:["",n.x.required],last_name:["",n.x.required],email:["",n.x.required],id:[""],profile_img:[""],folder:["users"]})}return e.prototype.ngOnInit=function(){var e=localStorage.getItem("token");e&&(this.authUser=c(e)),this.common.dataLoading=!1,this.setFormFields(),this.getRedirectUrl(),this.getUserCards()},e.prototype.setFormFields=function(){var e=this;this._route.data.subscribe((function(t){e.userData=t.user,e.profileForm.patchValue(e.userData)}))},e.prototype.buildFormData=function(){var e=new FormData,t=this.profileForm.value,r=Object.entries(this.dropzoneFile).length>0;for(var n in this.profileForm.value)"birthday"===n?t.birthday&&e.append(n,this.profileForm.value[n]):"profile_img"===n&&r||e.append(n,this.profileForm.value[n]?this.profileForm.value[n]:"");if(r){var o=this.dropzoneFile[0],i=o.name.split("."),a=i[0]+"."+i[1];e.append("profile_img",a),e.append("profile_img_file",o,a)}return e},e.prototype.save=function(){var e=this,t=this.buildFormData();this.auth.update(t).subscribe((function(t){e.router.navigate([e.redirectUrl]),e.toastr.success("The profile has been updated successfully")}))},e.prototype.removeImage=function(){this.userData.profile_img="",this.dropzoneFile={},this.profileForm.controls.profile_img.patchValue("")},e.prototype.addUserWithCard=function(){var e=this,t=this.authUser.full_name;this.stripeService.createToken(this.card.getCard(),{name:t}).subscribe((function(r){if(console.log(r),r.token){var n=r.token.card;console.log(r.token.id),e.usersService.createStripeCard({stripeToken:r.token.id,stripeEmail:e.authUser.email,holderName:t,user_id:e.authUser.id,exp_month:n.exp_month,exp_year:n.exp_year,last4:n.last4,brand:n.brand,country:n.country}).subscribe((function(e){}))}else r.error&&console.log(r.error.message)}))},e.prototype.onAddedFile=function(e){this.dropzoneFile=e},e.prototype.getUserCards=function(){this.usersService.getUserCards({user_id:this.authUser.id}).subscribe((function(e){}))},Object.defineProperty(e.prototype,"firstName",{get:function(){return this.profileForm.get("first_name")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastName",{get:function(){return this.profileForm.get("last_name")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this.profileForm.get("email")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pass",{get:function(){return this.profileForm.get("password")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profileImg",{get:function(){return!!this.userData&&this.userData.profile_img},enumerable:!0,configurable:!0}),e.prototype.getRedirectUrl=function(){this.redirectUrl=(this.auth.checkRoles("partner")?"partners":this.auth.checkRoles("admin")?"admin":"employees")+"/dashboard/show"},e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](n.d),m["\u0275\u0275directiveInject"](d.a),m["\u0275\u0275directiveInject"](a.a),m["\u0275\u0275directiveInject"](d.d),m["\u0275\u0275directiveInject"](s.a),m["\u0275\u0275directiveInject"](u.b),m["\u0275\u0275directiveInject"](l.c),m["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit-user-profile"]],viewQuery:function(e,t){var r;1&e&&m["\u0275\u0275viewQuery"](l.b,!0),2&e&&m["\u0275\u0275queryRefresh"](r=m["\u0275\u0275loadQuery"]())&&(t.card=r.first)},decls:30,vars:14,consts:[[1,"formContainer"],["method","post","enctype","multipart/form-data",1,"profileForm",3,"formGroup"],[1,"terminalTitle"],["translate",""],[1,"userInfo"],["matInput","","required","",3,"placeholder","formControlName"],["class","error",4,"ngIf"],["matInput","","formControlName","email","required","",3,"placeholder"],[1,"card-area"],[3,"options","elementsOptions"],["mat-raised-button","",3,"click"],[3,"diameter",4,"ngIf"],["type","button",1,"backBtn",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"userImg"],["id","dropzone","class","profileImgDropzone",3,"config","message","removedFile","thumbnail",4,"ngIf"],["class","profileImg",3,"background",4,"ngIf"],[1,"error"],[4,"ngIf"],[3,"hidden"],[3,"diameter"],["id","dropzone",1,"profileImgDropzone",3,"config","message","removedFile","thumbnail"],["dropzone",""],[1,"profileImg"],[1,"fa","fa-times-circle","remove-profile-img",3,"click"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"div",0),m["\u0275\u0275elementStart"](1,"form",1),m["\u0275\u0275elementStart"](2,"h2",2),m["\u0275\u0275elementStart"](3,"mat-icon"),m["\u0275\u0275text"](4,"person"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](5,"span",3),m["\u0275\u0275text"](6,"Profile"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](7,"div",4),m["\u0275\u0275elementStart"](8,"mat-form-field"),m["\u0275\u0275element"](9,"input",5),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](10,_,2,1,"div",6),m["\u0275\u0275elementStart"](11,"mat-form-field"),m["\u0275\u0275element"](12,"input",5),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](13,O,2,1,"div",6),m["\u0275\u0275elementStart"](14,"mat-form-field"),m["\u0275\u0275element"](15,"input",7),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](16,F,5,2,"div",6),m["\u0275\u0275elementStart"](17,"div",8),m["\u0275\u0275element"](18,"ngx-stripe-card",9),m["\u0275\u0275elementStart"](19,"button",10),m["\u0275\u0275listener"]("click",(function(){return t.addUserWithCard()})),m["\u0275\u0275text"](20,"ADD CARD"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](21,P,1,1,"mat-spinner",11),m["\u0275\u0275elementStart"](22,"button",12),m["\u0275\u0275listener"]("click",(function(){return t.router.navigate([t.redirectUrl])})),m["\u0275\u0275elementStart"](23,"mat-icon"),m["\u0275\u0275text"](24,"arrow_back"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](25,"button",13),m["\u0275\u0275listener"]("click",(function(){return t.save()})),m["\u0275\u0275text"](26," Save "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](27,"div",14),m["\u0275\u0275template"](28,S,2,2,"dropzone",15),m["\u0275\u0275template"](29,E,3,6,"div",16),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("formGroup",t.profileForm),m["\u0275\u0275advance"](8),m["\u0275\u0275property"]("placeholder","First name")("formControlName","first_name"),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.firstName.errors&&(!t.firstName.pristine||t.firstName.touched)),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("placeholder","Last Name")("formControlName","last_name"),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.lastName.errors&&(!t.lastName.pristine||t.lastName.touched)),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("placeholder","Email"),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.email.errors&&(!t.email.pristine||t.email.touched)),m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("options",t.cardOptions)("elementsOptions",t.elementsOptions),m["\u0275\u0275advance"](3),m["\u0275\u0275property"]("ngIf",t.common.formProcessing),m["\u0275\u0275advance"](7),m["\u0275\u0275property"]("ngIf",!t.profileImg),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf",t.profileImg))},directives:[n.z,n.p,n.h,f.a,g.b,h.b,n.b,n.v,n.o,n.g,v.l,l.b,b.b,y.b,i.b],pipes:[C.a],styles:[".formContainer[_ngcontent-%COMP%]{display:flex;width:90%;margin:0 auto}.profileForm[_ngcontent-%COMP%]{margin:50px auto;max-width:680px;width:100%;float:left}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]{width:40%;float:left}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]   .register[_ngcontent-%COMP%]{background-color:#82c644;color:#fff;text-transform:uppercase;font-weight:700;display:flex;justify-content:center;border:none;padding:5px;cursor:pointer;outline:none;margin:auto}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]   .register[_ngcontent-%COMP%]:disabled{background-color:#c6ccd4!important}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{display:block}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]   .mat-radio-group[_ngcontent-%COMP%]{margin:20px 0;display:block;text-align:center}.profileForm[_ngcontent-%COMP%]   .userInfo[_ngcontent-%COMP%]   .mat-radio-group[_ngcontent-%COMP%]   .mat-radio-button[_ngcontent-%COMP%]{margin-left:10px}.profileForm[_ngcontent-%COMP%]   .userImg[_ngcontent-%COMP%]{width:50%;float:right}.profileForm[_ngcontent-%COMP%]   .userImg[_ngcontent-%COMP%]   .profileImg[_ngcontent-%COMP%]{position:relative;width:400px;height:400px;background-size:cover!important}.profileForm[_ngcontent-%COMP%]   .userImg[_ngcontent-%COMP%]   .profileImg[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:2px;color:#fff;font-size:20px;cursor:pointer}"]}),e}()},nPaU:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("7dP1"),o=r("TYT/"),i=function(){function e(e){this._auth=e}return e.prototype.resolve=function(e){return this._auth.getUser({email:this._auth.userData.email})},e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](n.a))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},tVj7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("9xOu"),o=r("TYT/"),i=r("cUzu"),a=function(){function e(e){this.http=e}return e.prototype.getUserById=function(e){return this.http.get(n.g+"users/getById",{params:e})},e.prototype.getUsersByRole=function(e){return this.http.get(n.g+"users/get-by-role",{params:e})},e.prototype.createStripeCard=function(e){return this.http.post(n.g+"users/create-stripe-user-card",e)},e.prototype.getUserCards=function(e){return this.http.get(n.g+"users/get-customer-cards",{params:e})},e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](i.b))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}]);